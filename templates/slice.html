<h2>Choose an audio file (WAV or AIFF) to slice into a Kit</h2>
{message_html}
<form enctype="multipart/form-data" method="post">
    <input type="hidden" name="action" value="slice"/>
    <input type="hidden" name="mode" id="mode" value="download"/>
    
    <label for="file">Select Audio file:</label>
    <input id="file" name="file" type="file" accept=".wav, .aif, .aiff" required/>
    <br/><br/>

    <label for="kit_type">Kit Type:</label>
    <select id="kit_type" name="kit_type">
        <option value="choke" selected>Choke Kit – Pads play through, one at a time</option>
        <option value="gate">Gate Kit – Pads play while held, multiples at once</option>
        <option value="drum">Drum Kit – Pads play through, multiples at once</option>
    </select>
    <br/><br/>

    <label for="num_slices">Number of slices (1-16):</label>
    <input id="num_slices" name="num_slices" type="number" min="1" max="16" value="16" required/>
    <br/>
    <label for="sensitivity" style="margin-right: 0.5em;">Transient Sensitivity:</label>
    <input type="range" id="sensitivity" name="sensitivity" min="0.01" max="0.20" step="0.01" value="0.07" style="vertical-align: middle; width:120px;">
    <span id="sensitivity-value" style="margin-left: 0.5em;">0.07</span>
    <br/>
    <!--
    <input type="checkbox" id="transient_detect" name="transient_detect" value="1" onclick="toggleNumSlices()"/>
    <label for="transient_detect">Detect slices by transients (max 16)</label>
    <input type="hidden" id="transient_detect_hidden" name="transient_detect" value="0"/>
    -->
    <br/>
    <button type="button" id="detect-transients-btn">Detect Slices by Transients</button>
    <span id="transient-detect-message" style="margin-left: 1em; color: #337ab7;"></span>
    <br/><br/>
    
    <button type="submit" onclick="document.getElementById('mode').value = 'download'">
        Download .ablpresetbundle
    </button>
    <button type="submit" onclick="document.getElementById('mode').value = 'auto_place'">
        Save Preset directly on Move
    </button>
    <script>
    function toggleNumSlices() {
        const cb = document.getElementById('transient_detect');
        const numSlicesInput = document.getElementById('num_slices');
        numSlicesInput.disabled = cb.checked;
        document.getElementById('transient_detect_hidden').value = cb.checked ? "1" : "0";
    }
    </script>
</form>
<br/><br/>
    
<!-- Waveform container -->
<div id="waveform" style="width: 100%; height: 128px;"></div>
<br/>
