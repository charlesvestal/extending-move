{% extends "base.html" %}
{% block content %}
<h2>Pad Dropdown Demo</h2>
<div id="pad-dropdown" class="pad-dropdown">
  <div class="dropdown-toggle">
    <span class="preview-label"></span>
    <span class="arrow">&#9662;</span>
  </div>
  <div class="dropdown-menu"></div>
  <input type="hidden" id="pad-index" name="pad_index" value="1">
</div>
{% endblock %}
{% block scripts %}
<style>
.pad-dropdown { position: relative; width: 200px; font-size: 0.875rem; }
.pad-dropdown .dropdown-toggle { border: 1px solid #ddd; border-radius: 4px; padding: 0.5rem; cursor: pointer; display:flex; align-items:center; background: #fff; }
.pad-dropdown .arrow { margin-left: auto; }
.pad-dropdown .dropdown-menu { position: absolute; top: 100%; left: 0; right: 0; background: #fff; border: 1px solid #ddd; border-radius: 4px; max-height: 200px; overflow-y: auto; z-index: 1000; }
.pad-dropdown .dropdown-item { padding: 0.5rem; cursor: pointer; }
.pad-dropdown .dropdown-item:hover { background-color: #f0f0f0; }
</style>
<script>
const padNumbers = {{ pad_numbers_json|safe }};
function initPadDropdown() {
  const container = document.getElementById('pad-dropdown');
  const toggle = container.querySelector('.dropdown-toggle');
  const menu = container.querySelector('.dropdown-menu');
  const hiddenInput = container.querySelector('input[type="hidden"]');
  let open = false;
  let selectedIndex = 0;

  function renderMenu() {
    menu.innerHTML = '';
    padNumbers.forEach((num, idx) => {
      const item = document.createElement('div');
      item.className = 'dropdown-item';
      item.dataset.index = idx;
      item.textContent = 'Pad ' + num;
      item.addEventListener('click', () => {
        selectedIndex = idx;
        hiddenInput.value = num;
        updateToggle();
        closeMenu();
      });
      menu.appendChild(item);
    });
  }

  function updateToggle() {
    toggle.querySelector('.preview-label').textContent = 'Pad ' + padNumbers[selectedIndex];
  }

  function openMenu() { menu.style.display = 'block'; open = true; }
  function closeMenu() { menu.style.display = 'none'; open = false; }

  toggle.addEventListener('click', (e) => { e.stopPropagation(); open ? closeMenu() : openMenu(); });
  document.addEventListener('click', (e) => { if (open && !container.contains(e.target)) closeMenu(); });

  renderMenu();
  updateToggle();
  closeMenu();
}
document.addEventListener('DOMContentLoaded', initPadDropdown);
</script>
{% endblock %}
